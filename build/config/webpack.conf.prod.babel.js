'use strict';

// +-------+-------------------------------------------------------------------+
// | Title | Imports                                                           |
// +-------+-------------------------------------------------------------------+

// Webpack plugins
// -----------------------------------------------------------------------------

import WebpackMerge from 'webpack-merge';

// Webpack parts
// -----------------------------------------------------------------------------

// Base config

import commonConfig from './webpack.conf.common';

// Output

import { OUTPUT } from './webpack.conf.watch.babel'

// Optimization

import optimization from './parts/optimization';

// Plugins

import dynamicCdnWebpackPlugin from './parts/plugins/dynamic-cdn-webpack-plugin';

import { MCEP } from './webpack.conf.watch.babel'

// +-------+-------------------------------------------------------------------+
// | Title |                                                                   |
// +-------+-------------------------------------------------------------------+

const key = {
  cdn: false,
};

// +-------+-------------------------------------------------------------------+
// | Title | Production config                                                 |
// +-------+-------------------------------------------------------------------+

const prodConfig = new WebpackMerge([

  // +-----------+-------------------------------------------------------------+
  // | Title     | Output                                                      |
  // +-----------+-------------------------------------------------------------+

  OUTPUT,

  // +-----------+-------------------------------------------------------------+
  // | Title     | Optimization                                                |
  // +-----------+-------------------------------------------------------------+
  // | Descr     |                                                             |
  // +-----------+-------------------------------------------------------------+
  // | Structure | optimization                                                |
  // +-----------+-------------------------------------------------------------+

  // optimization({
  //   name: 'vendors',
  //   filename: '[name]' + CONTENTHASH + '.js', // './'
  // }),

  optimization,

  // +-------+-----------------------------------------------------------------+
  // | Title | Plugins                                                         |
  // +-------+-----------------------------------------------------------------+

  key.cdn ? dynamicCdnWebpackPlugin : MCEP,
]);

// +-------+-------------------------------------------------------------------+
// | Title | Webpack config                                                    |
// +-------+-------------------------------------------------------------------+

const config = new WebpackMerge([ commonConfig, prodConfig ]);

// +-------+-------------------------------------------------------------------+
// | Title | Exports                                                           |
// +-------+-------------------------------------------------------------------+

export default config;
